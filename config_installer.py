from tkinter import *
from tkinter.filedialog import askdirectory
from analytic import get_id
import keen

keen.project_id, keen.write_key, keen.read_key = get_id()

class KeyCapture:
    def __init__(self, master):
        self.master = master
        self.key = None
        self.label_prompt = None
        self.label_response = None
        
        # Create a "Start" button
        self.start_button = Button(self.master, text="Choose a key to set as the toggle bind", command=self.capture_key)
        self.start_button.pack(pady=5)
        
        # Bind keyboard events to the root window
        self.master.bind("<Key>", self.key_pressed)

    def capture_key(self):
        # Disable the "Start" button and display instructions
        self.start_button.config(state=DISABLED, text="Press a key...")
        self.label_prompt = Label(self.master, text="Press a key on your keyboard or mouse.")
        self.label_prompt.pack(pady=5)

    def key_pressed(self, event):
        # Save the pressed key and update the UI
        if self.label_response is not None:
            self.label_response.destroy()
        self.key = event.keysym
        self.label_response = Label(self.master, text=f"Key '{self.key}' captured!")
        self.label_response.pack(pady=5)
        self.start_button.config(state=NORMAL, text="Start") # Re-enable the "Start" button
        self.label_prompt.destroy()

class DirectorySelector:
    def __init__(self, master):
        self.master = master
        self.selected_directory = None
        
        # Create a "Select directory" button
        select_directory_button = Button(self.master, text="Select directory", command=self.get_directory)
        select_directory_button.pack(pady=5)

    def get_directory(self):
        directory = askdirectory()
        self.selected_directory = directory
        
class GetStrafeType:
    def __init__(self, master):
        self.master = master
        self.strafe_type = None
        
        # Create a "Select directory" button
        strafe = StringVar(master)
        strafe.set("Select type of strafe")
        self.strafe = OptionMenu(master, strafe, "Neo strafe", "2 directional strafe", "Superglide", command=self.set_type)
        self.strafe.pack(pady=5)
        
    def set_type(self, selected_type):
        self.strafe_type = selected_type

def destroy():
    global error_label
    if get_key.key and get_directory.selected_directory and get_strafe_type.strafe_type:
        master.destroy()
    else:
        if not error_label:
            error_label = Label(master, text="Please select all 3 options before pressing the button")
            error_label.pack(pady=5)

global error_label
error_label = None

 # Create the tkinter menu
master = Tk()
master.minsize(350, 200)
get_key = KeyCapture(master)
get_directory = DirectorySelector(master)
get_strafe_type = GetStrafeType(master)

confirm = Button(master, text="Press this once all 3 options have been set to your liking", command=destroy)
confirm.pack(pady=5)

master.mainloop()

 # Get the variables from the tkinter objects
key = get_key.key
directory = get_directory.selected_directory + "/cfg/"
strafe_type = get_strafe_type.strafe_type

 # Set the relevant filenames and content
if strafe_type == "2 directional strafe":
    filenames = ['2directionalstrafe1.cfg', f'2directionalstrafe00010.cfg', f'2directionalstrafe00011.cfg', f'2directionalstrafe00012.cfg', f'2directionalstrafe00013.cfg', f'2directionalstrafe00014.cfg', f'2directionalstrafe00015.cfg', f'2directionalstrafe00016.cfg', f'2directionalstrafe00017.cfg', f'2directionalstrafe0002.cfg', f'2directionalstrafe0003.cfg', f'2directionalstrafe0004.cfg', f'2directionalstrafe0005.cfg', f'2directionalstrafe0006.cfg', f'2directionalstrafe0007.cfg', f'2directionalstrafe0008.cfg', f'2directionalstrafe0009.cfg', f'2directionalstrafe0010.cfg', f'2directionalstrafe0011.cfg', f'2directionalstrafe0012.cfg', f'2directionalstrafe0013.cfg', f'2directionalstrafe0014.cfg', f'2directionalstrafe0015.cfg', f'2directionalstrafe0016.cfg', f'2directionalstrafe0017.cfg', f'2directionalstrafe002.cfg', f'2directionalstrafe003.cfg', f'2directionalstrafe004.cfg', f'2directionalstrafe005.cfg', f'2directionalstrafe006.cfg', f'2directionalstrafe007.cfg',
                 '2directionalstrafe008.cfg', f'2directionalstrafe009.cfg', f'2directionalstrafe010.cfg', f'2directionalstrafe011.cfg', f'2directionalstrafe012.cfg', f'2directionalstrafe013.cfg', f'2directionalstrafe014.cfg', f'2directionalstrafe015.cfg', f'2directionalstrafe016.cfg', f'2directionalstrafe017.cfg', f'2directionalstrafe02.cfg', f'2directionalstrafe03.cfg', f'2directionalstrafe04.cfg', f'2directionalstrafe05.cfg', f'2directionalstrafe06.cfg', f'2directionalstrafe07.cfg', f'2directionalstrafe08.cfg', f'2directionalstrafe09.cfg', f'2directionalstrafe10.cfg', f'2directionalstrafe11.cfg', f'2directionalstrafe12.cfg', f'2directionalstrafe13.cfg', f'2directionalstrafe14.cfg', f'2directionalstrafe15.cfg', f'2directionalstrafe16.cfg', f'2directionalstrafe17.cfg', f'2directionalstrafe2.cfg', f'2directionalstrafe3.cfg', f'2directionalstrafe4.cfg', f'2directionalstrafe5.cfg', f'2directionalstrafe6.cfg', f'2directionalstrafe7.cfg', f'2directionalstrafe8.cfg', f'2directionalstrafe9.cfg']
    content = [f'bind "MWHEELDOWN" "+jump"\nbind "MWHEELUP" "+forward"\nbind "{key}" "exec 2directionalstrafe0002.cfg" ', f'bind "MWHEELDOWN" "+jump; +backward; exec 2directionalstrafe0010.cfg" \nbind "MWHEELUP" "+jump; exec 2directionalstrafe0007.cfg"\nbind "{key}" "exec 2directionalstrafe1.cfg" ', f'bind "MWHEELDOWN" "+jump; +backward; +moveright; exec 2directionalstrafe0011.cfg" \nbind "MWHEELUP" "+jump; exec 2directionalstrafe0006.cfg" \nbind "{key}" "exec 2directionalstrafe1.cfg" \n', f'bind "MWHEELDOWN" "+jump; +moveright; exec 2directionalstrafe0012.cfg" \nbind "MWHEELUP" "+jump; exec 2directionalstrafe0005.cfg"\nbind "{key}" "exec 2directionalstrafe1.cfg" ', f'bind "MWHEELDOWN" "+jump; +moveright; +forward; exec 2directionalstrafe0013.cfg" \nbind "MWHEELUP" "+jump; exec 2directionalstrafe0004.cfg"\nbind "{key}" "exec 2directionalstrafe1.cfg" \n', f'bind "MWHEELDOWN" "+jump; +forward; exec 2directionalstrafe0014.cfg" \nbind "MWHEELUP" "+jump; exec 2directionalstrafe0003.cfg" \nbind "{key}" "exec 2directionalstrafe1.cfg" \n ', f'bind "MWHEELDOWN" "+jump; +forward; +moveleft; exec 2directionalstrafe0015.cfg"\nbind "MWHEELUP" "+jump; exec 2directionalstrafe0002.cfg"  \nbind "{key}" "exec 2directionalstrafe1.cfg" ', f'bind "MWHEELDOWN" "+jump; +moveleft; exec 2directionalstrafe0016.cfg" \nbind "MWHEELup" "+jump; exec 2directionalstrafe0009.cfg" \nbind "{key}" "exec 2directionalstrafe1.cfg" \n ', f'bind "MWHEELDOWN" "+jump; +moveleft; +backward; exec 2directionalstrafe0017.cfg"\nbind "MWHEELUP" "+jump; exec 2directionalstrafe0008.cfg"  \nbind "{key}" "exec 2directionalstrafe1.cfg" ', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00015.cfg" \nbind "MWHEELUP" "+jump; +forward; exec 2directionalstrafe002.cfg"\nbind "{key}" "exec 2directionalstrafe1.cfg" \n', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00014.cfg" \nbind "MWHEELUP" "+jump; +forward; +moveright; exec 2directionalstrafe003.cfg" \nbind "{key}" "exec 2directionalstrafe1.cfg" \n ', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00013.cfg"\nbind "MWHEELUP" "+jump; +moveright; exec 2directionalstrafe004.cfg"  \nbind "{key}" "exec 2directionalstrafe1.cfg" ', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00012.cfg" \nbind "MWHEELup" "+jump; +backward; +moveright; exec 2directionalstrafe005.cfg" \nbind "{key}" "exec 2directionalstrafe1.cfg" \n ', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00011.cfg"\nbind "MWHEELUP" "+jump; +backward; exec 2directionalstrafe006.cfg"  \nbind "{key}" "exec 2directionalstrafe1.cfg" ', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00010.cfg" \nbind "MWHEELUP" "+jump; +backward; +moveleft; exec 2directionalstrafe007.cfg"\nbind "{key}" "exec 2directionalstrafe1.cfg" ', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00017.cfg" \nbind "MWHEELUP" "+jump; +moveleft; exec 2directionalstrafe008.cfg" \nbind "{key}" "exec 2directionalstrafe1.cfg" \n', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00016.cfg" \nbind "MWHEELUP" "+jump; +forward; +moveleft; exec 2directionalstrafe009.cfg"\nbind "{key}" "exec 2directionalstrafe1.cfg" ', f'bind "MWHEELDOWN" "+jump; +backward; exec 2directionalstrafe010.cfg" \nbind "MWHEELUP" "+jump; exec 2directionalstrafe0007.cfg"\nbind "{key}" "exec 2directionalstrafe1.cfg" ', f'bind "MWHEELDOWN" "+jump; +backward; +moveright; exec 2directionalstrafe011.cfg" \nbind "MWHEELUP" "+jump; exec 2directionalstrafe0006.cfg" \nbind "{key}" "exec 2directionalstrafe1.cfg" \n', f'bind "MWHEELDOWN" "+jump; +moveright; exec 2directionalstrafe012.cfg" \nbind "MWHEELUP" "+jump; exec 2directionalstrafe0005.cfg"\nbind "{key}" "exec 2directionalstrafe1.cfg" ', f'bind "MWHEELDOWN" "+jump; +moveright; +forward; exec 2directionalstrafe013.cfg" \nbind "MWHEELUP" "+jump; exec 2directionalstrafe0004.cfg" \nbind "{key}" "exec 2directionalstrafe1.cfg" \n', f'bind "MWHEELDOWN" "+jump; +forward; exec 2directionalstrafe014.cfg" \nbind "MWHEELUP" "+jump; exec 2directionalstrafe0003.cfg"\nbind "{key}" "exec 2directionalstrafe1.cfg" \n', f'bind "MWHEELDOWN" "+jump; +forward; +moveleft; exec 2directionalstrafe015.cfg" \nbind "MWHEELUP" "+jump; exec 2directionalstrafe0002.cfg" \nbind "{key}" "exec 2directionalstrafe1.cfg" \n ', f'bind "MWHEELDOWN" "+jump; +moveleft; exec 2directionalstrafe016.cfg"\nbind "MWHEELUP" "+jump; exec 2directionalstrafe0009.cfg"  \nbind "{key}" "exec 2directionalstrafe1.cfg" ', f'bind "MWHEELDOWN" "+jump; +moveleft; +backward; exec 2directionalstrafe017.cfg" \nbind "MWHEELup" "+jump; exec 2directionalstrafe0008.cfg" \nbind "{key}" "exec 2directionalstrafe1.cfg" \n ', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00015.cfg" \nbind "MWHEELUP" "+jump; +forward; exec 2directionalstrafe02.cfg" \nbind "{key}" "exec 2directionalstrafe1.cfg" \n', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00014.cfg" \nbind "MWHEELUP" "+jump; +forward; +moveright; exec 2directionalstrafe03.cfg"\nbind "{key}" "exec 2directionalstrafe1.cfg" \n', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00013.cfg" \nbind "MWHEELUP" "+jump; +moveright; exec 2directionalstrafe04.cfg" \nbind "{key}" "exec 2directionalstrafe1.cfg" \n ', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00012.cfg"\nbind "MWHEELUP" "+jump; +backward; +moveright; exec 2directionalstrafe05.cfg"  \nbind "{key}" "exec 2directionalstrafe1.cfg" ', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00011.cfg" \nbind "MWHEELup" "+jump; +backward; exec 2directionalstrafe06.cfg" \nbind "{key}" "exec 2directionalstrafe1.cfg" \n ', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00010.cfg" \nbind "MWHEELUP" "+jump; +backward; +moveleft; exec 2directionalstrafe07.cfg"\nbind "{key}" "exec 2directionalstrafe1.cfg" ', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00017.cfg" \nbind "MWHEELUP" "+jump; +moveleft; exec 2directionalstrafe08.cfg" \nbind "{key}" "exec 2directionalstrafe1.cfg" \n', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00016.cfg" \nbind "MWHEELUP" "+jump; +forward; +moveleft; exec 2directionalstrafe09.cfg"\nbind "{key}" "exec 2directionalstrafe1.cfg" ',
               f'bind "MWHEELDOWN" "+jump; +backward; exec 2directionalstrafe10.cfg" \nbind "MWHEELUP" "+jump; exec 2directionalstrafe0007.cfg"\nbind "{key}" "exec 2directionalstrafe1.cfg" ', f'bind "MWHEELDOWN" "+jump; +backward; +moveright; exec 2directionalstrafe11.cfg" \nbind "MWHEELUP" "+jump; exec 2directionalstrafe0006.cfg" \nbind "{key}" "exec 2directionalstrafe1.cfg" \n', f'bind "MWHEELDOWN" "+jump; +moveright; exec 2directionalstrafe12.cfg" \nbind "MWHEELUP" "+jump; exec 2directionalstrafe0005.cfg"\nbind "{key}" "exec 2directionalstrafe1.cfg" ', f'bind "MWHEELDOWN" "+jump; +moveright; +forward; exec 2directionalstrafe13.cfg" \nbind "MWHEELUP" "+jump; exec 2directionalstrafe0004.cfg" \nbind "{key}" "exec 2directionalstrafe1.cfg" \n', f'bind "MWHEELDOWN" "+jump; +forward; exec 2directionalstrafe14.cfg" \nbind "MWHEELUP" "+jump; exec 2directionalstrafe0003.cfg"\nbind "{key}" "exec 2directionalstrafe1.cfg" \n', f'bind "MWHEELDOWN" "+jump; +forward; +moveleft; exec 2directionalstrafe15.cfg" \nbind "MWHEELUP" "+jump; exec 2directionalstrafe0002.cfg" \nbind "{key}" "exec 2directionalstrafe1.cfg" \n ', f'bind "MWHEELDOWN" "+jump; +moveleft; exec 2directionalstrafe16.cfg"\nbind "MWHEELUP" "+jump; exec 2directionalstrafe0009.cfg"  \nbind "{key}" "exec 2directionalstrafe1.cfg" ', f'bind "MWHEELDOWN" "+jump; +moveleft; +backward; exec 2directionalstrafe17.cfg" \nbind "MWHEELup" "+jump; exec 2directionalstrafe0008.cfg" \nbind "{key}" "exec 2directionalstrafe1.cfg" \n ', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00015.cfg" \nbind "MWHEELUP" "+jump; +forward; exec 2directionalstrafe2.cfg" \nbind "{key}" "exec 2directionalstrafe1.cfg" \n', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00014.cfg" \nbind "MWHEELUP" "+jump; +forward; +moveright; exec 2directionalstrafe3.cfg"\nbind "{key}" "exec 2directionalstrafe1.cfg" \n', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00013.cfg" \nbind "MWHEELUP" "+jump; +moveright; exec 2directionalstrafe4.cfg" \nbind "{key}" "exec 2directionalstrafe1.cfg" \n ', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00012.cfg"\nbind "MWHEELUP" "+jump; +backward; +moveright; exec 2directionalstrafe5.cfg"  \nbind "{key}" "exec 2directionalstrafe1.cfg" ', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00011.cfg" \nbind "MWHEELup" "+jump; +backward; exec 2directionalstrafe6.cfg" \nbind "{key}" "exec 2directionalstrafe1.cfg" \n ', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00010.cfg" \nbind "MWHEELUP" "+jump; +backward; +moveleft; exec 2directionalstrafe7.cfg"\nbind "{key}" "exec 2directionalstrafe1.cfg" ', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00017.cfg" \nbind "MWHEELUP" "+jump; +moveleft; exec 2directionalstrafe8.cfg" \nbind "{key}" "exec 2directionalstrafe1.cfg" \n', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00016.cfg" \nbind "MWHEELUP" "+jump; +forward; +moveleft; exec 2directionalstrafe9.cfg"\nbind "{key}" "exec 2directionalstrafe1.cfg" ', f'bind "MWHEELDOWN" "+jump; +backward; exec 2directionalstrafe00011.cfg" \nbind "MWHEELUP" "+jump; exec 2directionalstrafe0007.cfg" \nbind "{key}" "exec 2directionalstrafe1.cfg" \n', f'bind "MWHEELDOWN" "+jump; +backward; +moveright; exec 2directionalstrafe00012.cfg" \nbind "MWHEELUP" "+jump; exec 2directionalstrafe0006.cfg"\nbind "{key}" "exec 2directionalstrafe1.cfg" ', f'bind "MWHEELDOWN" "+jump; +moveright; exec 2directionalstrafe00013.cfg" \nbind "MWHEELUP" "+jump; exec 2directionalstrafe0005.cfg"\nbind "{key}" "exec 2directionalstrafe1.cfg"  ', f'bind "MWHEELDOWN" "+jump; +moveright; +forward; exec 2directionalstrafe00014.cfg" \nbind "MWHEELUP" "+jump; exec 2directionalstrafe0004.cfg" \nbind "{key}" "exec 2directionalstrafe1.cfg" \n', f'bind "MWHEELDOWN" "+jump; +forward; exec 2directionalstrafe00015.cfg" \nbind "MWHEELUP" "+jump; exec 2directionalstrafe0003.cfg"\nbind "{key}" "exec 2directionalstrafe1.cfg" \n', f'bind "MWHEELDOWN" "+jump; +forward; +moveleft; exec 2directionalstrafe00016.cfg" \nbind "MWHEELUP" "+jump; exec 2directionalstrafe0002.cfg" \nbind "{key}" "exec 2directionalstrafe1.cfg" \n ', f'bind "MWHEELDOWN" "+jump; +moveleft; exec 2directionalstrafe00017.cfg"\nbind "MWHEELUP" "+jump; exec 2directionalstrafe0009.cfg"  \nbind "{key}" "exec 2directionalstrafe1.cfg" ', f'bind "MWHEELDOWN" "+jump; +moveleft; +backward; exec 2directionalstrafe00010.cfg" \nbind "MWHEELup" "+jump; exec 2directionalstrafe0008.cfg" \nbind "{key}" "exec 2directionalstrafe1.cfg" \n ', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00015.cfg" \nbind "MWHEELUP" "+jump; +forward; exec 2directionalstrafe0003.cfg" \nbind "{key}" "exec 2directionalstrafe1.cfg" \n', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00014.cfg" \nbind "MWHEELUP" "+jump; +forward; +moveright; exec 2directionalstrafe0004.cfg"\nbind "{key}" "exec 2directionalstrafe1.cfg" \n', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00013.cfg" \nbind "MWHEELUP" "+jump; +moveright; exec 2directionalstrafe0005.cfg" \nbind "{key}" "exec 2directionalstrafe1.cfg" \n ', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00012.cfg"\nbind "MWHEELUP" "+jump; +backward; +moveright; exec 2directionalstrafe0006.cfg"  \nbind "{key}" "exec 2directionalstrafe1.cfg" ', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00011.cfg" \nbind "MWHEELup" "+jump; +backward; exec 2directionalstrafe0007.cfg" \nbind "{key}" "exec 2directionalstrafe1.cfg" \n ', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00010.cfg" \nbind "MWHEELUP" "+jump; +backward; +moveleft; exec 2directionalstrafe0008.cfg"\nbind "{key}" "exec 2directionalstrafe1.cfg" ', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00017.cfg" \nbind "MWHEELUP" "+jump; +moveleft; exec 2directionalstrafe0009.cfg" \nbind "{key}" "exec 2directionalstrafe1.cfg" \n', f'bind "MWHEELDOWN" "+jump; exec 2directionalstrafe00016.cfg" \nbind "MWHEELUP" "+jump; +forward; +moveleft; exec 2directionalstrafe0002.cfg"\nbind "{key}" "exec 2directionalstrafe1.cfg" ']
elif strafe_type == "Neo strafe": 
    filenames = ['neo_strafe0.cfg', 'neo_strafe01.cfg', 'neo_strafe02.cfg', 'neo_strafe03.cfg', 'neo_strafe04.cfg', 'neo_strafe05.cfg', 'neo_strafe06.cfg', 'neo_strafe07.cfg', 'neo_strafe08.cfg', 'neo_strafe11.cfg', 'neo_strafe12.cfg', 'neo_strafe13.cfg', 'neo_strafe14.cfg', 'neo_strafe15.cfg', 'neo_strafe16.cfg', 'neo_strafe17.cfg', 'neo_strafe18.cfg', 'neo_strafe21.cfg', 'neo_strafe22.cfg', 'neo_strafe23.cfg', 'neo_strafe24.cfg', 'neo_strafe25.cfg', 'neo_strafe26.cfg', 'neo_strafe27.cfg', 'neo_strafe28.cfg', 'neo_strafe31.cfg', 'neo_strafe32.cfg', 'neo_strafe33.cfg', 'neo_strafe34.cfg', 'neo_strafe35.cfg', 'neo_strafe36.cfg', 'neo_strafe37.cfg', 'neo_strafe38.cfg', 'neo_strafe41.cfg', 'neo_strafe42.cfg', 'neo_strafe43.cfg', 'neo_strafe44.cfg', 'neo_strafe45.cfg', 'neo_strafe46.cfg', 'neo_strafe47.cfg', 'neo_strafe48.cfg']
    content = [f'bind "MWHEELDOWN" "+jump"\nbind "MWHEELUP" "+forward"\nbind "{key}" "exec neo_strafe01.cfg" ', f'bind "MWHEELDOWN" "+jump; +forward; exec neo_strafe11.cfg"\nbind "MWHEELUP" "+jump; +forward; exec neo_strafe11.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +forward; +moveright; exec neo_strafe12.cfg"\nbind "MWHEELUP" "+jump; +forward; +moveright; exec neo_strafe12.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +moveright; exec neo_strafe13.cfg"\nbind "MWHEELUP" "+jump; +moveright; exec neo_strafe13.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +backward; +moveright; exec neo_strafe1{key}.cfg"\nbind "MWHEELUP" "+jump; +backward; +moveright; exec neo_strafe1{key}.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +backward; exec neo_strafe15.cfg"\nbind "MWHEELUP" "+jump; +backward; exec neo_strafe15.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +backward; +moveleft; exec neo_strafe16.cfg"\nbind "MWHEELUP" "+jump; +backward; +moveleft; exec neo_strafe16.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +moveleft; exec neo_strafe17.cfg"\nbind "MWHEELUP" "+jump; +moveleft; exec neo_strafe17.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +forward; +moveleft; exec neo_strafe18.cfg"\nbind "MWHEELUP" "+jump; +forward; +moveleft; exec neo_strafe18.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +forward; exec neo_strafe21.cfg"\nbind "MWHEELUP" "+jump; +forward; exec neo_strafe21.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +forward; +moveright; exec neo_strafe22.cfg"\nbind "MWHEELUP" "+jump; +forward; +moveright; exec neo_strafe22.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +moveright; exec neo_strafe23.cfg"\nbind "MWHEELUP" "+jump; +moveright; exec neo_strafe23.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +backward; +moveright; exec neo_strafe2{key}.cfg"\nbind "MWHEELUP" "+jump; +backward; +moveright; exec neo_strafe2{key}.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +backward; exec neo_strafe25.cfg"\nbind "MWHEELUP" "+jump; +backward; exec neo_strafe25.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +backward; +moveleft; exec neo_strafe26.cfg"\nbind "MWHEELUP" "+jump; +backward; +moveleft; exec neo_strafe26.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +moveleft; exec neo_strafe27.cfg"\nbind "MWHEELUP" "+jump; +moveleft; exec neo_strafe27.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +forward; +moveleft; exec neo_strafe28.cfg"\nbind "MWHEELUP" "+jump; +forward; +moveleft; exec neo_strafe28.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +forward; exec neo_strafe31.cfg"\nbind "MWHEELUP" "+jump; +forward; exec neo_strafe31.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +forward; +moveright; exec neo_strafe32.cfg"\nbind "MWHEELUP" "+jump; +forward; +moveright; exec neo_strafe32.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +moveright; exec neo_strafe33.cfg"\nbind "MWHEELUP" "+jump; +moveright; exec neo_strafe33.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +backward; +moveright; exec neo_strafe3{key}.cfg"\nbind "MWHEELUP" "+jump; +backward; +moveright; exec neo_strafe3{key}.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +backward; exec neo_strafe35.cfg"\nbind "MWHEELUP" "+jump; +backward; exec neo_strafe35.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +backward; +moveleft; exec neo_strafe36.cfg"\nbind "MWHEELUP" "+jump; +backward; +moveleft; exec neo_strafe36.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +moveleft; exec neo_strafe37.cfg"\nbind "MWHEELUP" "+jump; +moveleft; exec neo_strafe37.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +forward; +moveleft; exec neo_strafe38.cfg"\nbind "MWHEELUP" "+jump; +forward; +moveleft; exec neo_strafe38.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +forward; exec neo_strafe{key}1.cfg"\nbind "MWHEELUP" "+jump; +forward; exec neo_strafe{key}1.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +forward; +moveright; exec neo_strafe{key}2.cfg"\nbind "MWHEELUP" "+jump; +forward; +moveright; exec neo_strafe{key}2.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +moveright; exec neo_strafe{key}3.cfg"\nbind "MWHEELUP" "+jump; +moveright; exec neo_strafe{key}3.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +backward; +moveright; exec neo_strafe{key}{key}.cfg"\nbind "MWHEELUP" "+jump; +backward; +moveright; exec neo_strafe{key}{key}.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +backward; exec neo_strafe{key}5.cfg"\nbind "MWHEELUP" "+jump; +backward; exec neo_strafe{key}5.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +backward; +moveleft; exec neo_strafe{key}6.cfg"\nbind "MWHEELUP" "+jump; +backward; +moveleft; exec neo_strafe{key}6.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +moveleft; exec neo_strafe{key}7.cfg"\nbind "MWHEELUP" "+jump; +moveleft; exec neo_strafe{key}7.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +forward; +moveleft; exec neo_strafe{key}8.cfg"\nbind "MWHEELUP" "+jump; +forward; +moveleft; exec neo_strafe{key}8.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +forward; exec neo_strafe02.cfg"\nbind "MWHEELUP" "+jump; +forward; exec neo_strafe02.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +forward; +moveright; exec neo_strafe03.cfg"\nbind "MWHEELUP" "+jump; +forward; +moveright; exec neo_strafe03.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +moveright; exec neo_strafe0{key}.cfg"\nbind "MWHEELUP" "+jump; +moveright; exec neo_strafe0{key}.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +backward; +moveright; exec neo_strafe05.cfg"\nbind "MWHEELUP" "+jump; +backward; +moveright; exec neo_strafe05.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +backward; exec neo_strafe06.cfg"\nbind "MWHEELUP" "+jump; +backward; exec neo_strafe06.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +backward; +moveleft; exec neo_strafe07.cfg"\nbind "MWHEELUP" "+jump; +backward; +moveleft; exec neo_strafe07.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +moveleft; exec neo_strafe08.cfg"\nbind "MWHEELUP" "+jump; +moveleft; exec neo_strafe08.cfg"\nbind "{key}" "exec neo_strafe0.cfg"', f'bind "MWHEELDOWN" "+jump; +forward; +moveleft; exec neo_strafe01.cfg"\nbind "MWHEELUP" "+jump; +forward; +moveleft; exec neo_strafe01.cfg"\nbind "{key}" "exec neo_strafe0.cfg"']
else:
    filenames = ['superglide1.cfg', f'superglide2.cfg', f'superglide3.cfg']
    content = [f'bind "{key}" "+jump; exec superglide2.cfg"\nbind "MWHEELDOWN" "+jump"', f'bind "MWHEELDOWN" "+jump; fps_max 30; exec superglide3.cfg"', f'bind "MWHEELDOWN" "+duck; fps_max 0; exec superglide1.cfg"']
    
def autoexec(location, strafe_type):
    if strafe_type == "2 directional strafe":
        execute = "exec 2directionalstrafe1.cfg"
    elif strafe_type == "Neo strafe":
        execute = "exec neostrafe1.cfg"
    else:
        execute = "exec superglide1.cfg"
        
    with open(location+"autoexec.cfg", "a") as autoexec:
        autoexec.write(f'\n{execute}\n')

 # Edit the autoexec.cfg file
autoexec(directory, strafe_type)

 # Write the scripts to the files
for index, script in enumerate(content):
    with open(f"{directory}{filenames[index]}", "w") as f:
        f.write(script)

 # Log the event to the server
keen.add_event("ConfigTracker", {
  "keybind": key,
  "directory": directory,
  "type": strafe_type
})